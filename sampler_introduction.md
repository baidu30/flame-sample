# FlameBench采样器原理详解

## 概述

FlameBench提供了两种不同类型的采样器用于收集燃烧数据：
1. **ZeroDSampler (0D采样器)** - 用于零维燃烧模拟数据采样
2. **OneDSampler (1D采样器)** - 用于一维层流火焰模拟数据采样

这两种采样器分别针对不同维度的燃烧问题，收集相应的数据用于机器学习模型训练。

## ZeroDSampler (0D采样器)

### 工作原理

0D采样器用于零维燃烧模拟，这是一种理想化的燃烧模型，假设燃烧过程在单一控制体积内发生，不考虑空间变化。主要特点包括：

1. **恒容燃烧**: 燃烧发生在固定体积的容器中
2. **均匀混合**: 假设燃料和氧化剂完全混合
3. **时间演化**: 关注温度、压力和物种浓度随时间的变化
4. **快速化学反应**: 假设化学反应速率远快于混合速率

### 实现细节

从代码分析来看，ZeroDSampler继承自BaseSampler基类，但目前实现还不完整：
- 使用Cantera库进行化学反应计算
- 配置文件定义了机制、当量比范围、压力范围和温度范围
- 数据采样逻辑尚未完全实现（标记为todo）

### 数据特征

0D采样器生成的数据通常包含：
- 时间序列数据
- 温度、压力变化
- 各化学物种浓度变化
- 燃烧速率等关键参数

## OneDSampler (1D采样器)

### 工作原理

1D采样器用于一维层流火焰模拟，考虑了空间维度上的变化。主要特点包括：

1. **层流火焰结构**: 模拟预混火焰的结构和传播
2. **空间分布**: 考虑温度、速度和物种浓度在火焰厚度方向上的分布
3. **稳态解**: 通常求解稳态的层流火焰问题
4. **详细的化学动力学**: 包含完整的化学反应机制

### 实现流程

OneDSampler的完整工作流程包括以下几个步骤：

1. **配置加载**
   - 读取1D配置文件（1d_config.yaml）
   - 解析燃料类型、化学机制文件路径和气体状态参数

2. **火焰特性计算**
   - 使用Cantera计算层流火焰速度和火焰厚度
   - 这些参数对于设置后续的CFD模拟至关重要

3. **案例设置**
   - 更新OpenFOAM案例参数
   - 创建初始条件文件（0目录下的物种文件）
   - 更新边界条件和场设置
   - 更新化学机制文件路径

4. **CFD模拟执行**
   - 运行Allrun脚本执行OpenFOAM模拟
   - 使用reconstructPar命令重构并行计算结果

5. **数据收集**
   - 遍历时间目录收集数据
   - 解析温度(T)、压力(p)和各物种浓度数据
   - 处理uniform和非uniform场数据格式
   - 将数据合并为统一的numpy数组

### 技术细节

1. **依赖工具**
   - Cantera: 用于化学反应计算和火焰特性分析
   - OpenFOAM: 用于CFD模拟
   - PyYAML: 用于配置文件解析

2. **数据格式**
   - OpenFOAM场文件格式解析
   - 支持uniform和非uniform数据类型
   - 输出为numpy数组格式保存为.npy文件

3. **错误处理**
   - 捕获并报告OpenFOAM模拟执行错误
   - 提供详细的日志信息

### 数据特征

1D采样器生成的数据包含：
- 空间分布信息（沿火焰传播方向）
- 多个时间步的数据
- 温度、压力和所有化学物种的浓度
- 高分辨率的火焰结构信息

## 两种采样器的比较

| 特征 | ZeroDSampler | OneDSampler |
|------|--------------|-------------|
| 维度 | 0维（无空间变化） | 1维（考虑空间分布） |
| 物理模型 | 恒容燃烧 | 层流火焰传播 |
| 计算复杂度 | 低 | 高 |
| 数据量 | 相对较小 | 较大 |
| 计算资源 | 较少 | 需要CFD求解器 |
| 应用场景 | 快速燃烧特性分析 | 火焰结构详细分析 |

## 使用建议

1. **ZeroDSampler**适用于：
   - 快速燃烧特性筛选
   - 化学机制验证
   - 燃烧极限分析

2. **OneDSampler**适用于：
   - 火焰结构研究
   - 详细化学反应分析
   - 燃烧模型验证

## 注意事项

1. **环境依赖**：OneDSampler需要正确安装OpenFOAM环境
2. **计算资源**：1D模拟相比0D模拟需要更多计算资源和时间
3. **化学机制**：需要合适的化学机制文件支持
4. **错误处理**：目前代码中存在一些未完全实现的功能，需要进一步完善